# ZX Circuit Extraction Project Rules

## Layout
- No docs directory. All code in src/, scripts in scripts/
- Keep file names short and consistent
- Shared helpers only in src/utils.py

## Coding Style
- Keep code short and simple, minimal abstraction
- NO COMMENTS except critical ones
- Minimize error handling, rely on assert for invariants
- Minimize prints, only final summary or --verbose flag
- Deterministic by default (fixed seeds)
- Every script must exit non-zero on failure
- Proceed step-by-step, stop if previous step fails

## Structure
src/ - all implementation
scripts/ - all entrypoints/tools/main functions
artifacts/ - all outputs (data, models, graphs, traces, qasm, CSV, plots)

## Actions (3 types only)
- CNode: between frontier pairs
- Face: Rz gadget extraction (deg==1, non-trivial angle)
- Clifford: 1q Clifford gates

## Node embedding
- Kind embedding + [sin(θ), cos(θ), is_frontier, degree, is_boundary]

## Training
- Supervised: imitate PyZX trace
- RL: REINFORCE + baseline, minimize gate count

## Execution order (strict)
1. setup_env.sh
2. run_base.py → base.csv
3. dump_sup.py → traces + dataset
4. train_sup.py → sup.pt
5. run_gnn.py --ckpt sup.pt
6. train_rl.py --init sup.pt → rl.pt
7. run_gnn.py --ckpt rl.pt
8. cmp.py → comparison CSV + plots

